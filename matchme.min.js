(function(glob){function Matcher(a,b){this.opts=b||{},this.target=a,this.ok=!0}function matchme(a,b,c){var d;if(typeof b=="string"||b instanceof String)c=b,b={};return d=new Matcher(a,b),typeof c!="undefined"?d.query(c).ok:d}var version="!{pkg:version}",reExpr=/([\w\.]+)\s*([\>\<\!\=]\=?)\s*([\w\.]+)/,reQuotedExpr=/([\w\.]+)\s*([\>\<\!\=]\=?)\s*\"([^\"]+)\"/,reRegexExpr=/([\w\.]+)\s*([\=\!]\~)\s*(\/[^\s]+\/\w*)/,reRegex=/^\/(.*)\/(\w*)$/,reBool=/^(true|false)$/i,reFalsyWords=/(undefined|null|false)/g,reTruthyWords=/(true)/g,reWords=/(\w{2,})/,reSillyFn=/0\(.*?\)/g,exprLookups={"==":["equals"],">":["gt"],">=":["gte"],"<":["lt"],"<=":["lte"],"!=":["equals","not"],"=~":["regex"],"!~":["regex","not"]},wordReplacements={and:"&&",or:"||"};Matcher.prototype={_evaluateExpressions:function(a,b){var c=b.exec(a);while(c){var d=exprLookups[c[2]]||[],e={ok:d.length>0},f=parseFloat(c[1])||c[1],g=parseFloat(c[3])||c[3];reBool.test(g)&&(g=g=="true");for(var h=0,i=d.length;h<i;h++){var j=this[d[h]];j&&j.call(this,f,g,e)}a=a.slice(0,c.index)+e.ok+a.slice(c.index+c[0].length),c=b.exec(a)}return a},gt:function(a,b,c){return c=c||this,c.ok=c.ok&&this.target&&this.target[a]>b,this},gte:function(a,b,c){return c=c||this,c.ok=c.ok&&this.target&&this.target[a]>=b,this},lt:function(a,b,c){return c=c||this,c.ok=c.ok&&this.target&&this.target[a]<b,this},lte:function(a,b,c){return c=c||this,c.ok=c.ok&&this.target&&this.target[a]<=b,this},equals:function(a,b,c){c=c||this;if(c.ok&&this.target){var d=this.target[a],e=(typeof d=="string"||d instanceof String)&&(typeof b=="string"||b instanceof String);e&&!this.opts.caseSensitive?c.ok=d.toLowerCase()===b.toLowerCase():c.ok=d===b}return this},not:function(a,b,c){return c=c||this,c.ok=!c.ok,this},regex:function(a,b,c){c=c||this;if(c.ok&&this.target){var d=reRegex.exec(b);d&&(c.ok=(new RegExp(d[1],d[2])).test(this.target[a]))}return this},query:function(text){var match;text=this._evaluateExpressions(text,reQuotedExpr),text=this._evaluateExpressions(text,reRegexExpr),text=this._evaluateExpressions(text,reExpr),text=text.replace(reFalsyWords,"0").replace(reTruthyWords,"1"),match=reWords.exec(text);while(match){var replacement=wordReplacements[match[0].toLowerCase()];!replacement&&this.target&&(replacement=this.target[match[0]]),text=text.slice(0,match.index)+replacement+text.slice(match.index+match[0].length),text=text.replace(reFalsyWords,"0").replace(reTruthyWords,"1"),match=reWords.exec(text)}text=text.replace(reSillyFn,"0");try{this.ok=eval(text)==1}catch(e){this.ok=!1,this._errtext=text}return this}},matchme.filter=function(a,b,c){var d;if(typeof a=="string"||a instanceof String)c=b,b=a,a=null;d=new Matcher(null,c);if(a){var e=[];for(var f=0,g=a.length;f<g;f++)d.target=a[f],d.query(b).ok&&(e[e.length]=a[f]);return e}return function(a){return d.target=a,d.query(b).ok}},typeof module!="undefined"&&module.exports?module.exports=matchme:typeof define!="undefined"?define("matchme",[],function(){return matchme}):glob.matchme=matchme})(this)